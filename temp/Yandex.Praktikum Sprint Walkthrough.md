<h2>Выполнение учебного проекта Яндекс.Практикума</h2>

<h3>Добрый день, дорогие друзья!</h3>

Рассмотрим один самостоятельных проектов, которые предлагает платформа Яндекс.Практикум на направлении "Специалист по Data Science".  
Проект является завершением двухнедельного спринта по теме "Машинное обучение в бизнесе". За 14 дней мы узнаем, как DS помогает бизнесу развиваться, что такое Bootstrap, 
зачем нужно проводить A/B тестирование и как правильно размечать выборку для моделей обучения.  
В статье не будет подробного разбора всего решения, поскольку данные - интеллектуальная собственность Яндекса. Приходите на курс и увидите сами.

Выполнение проектов занимает от 3 до 5 дней, в зависимости от сложности задания и загруженности рабочего графике.  
В процессе выполнения проекта перенемся немного в будущее и представим себя в роли сайентиста фирмы «ГлавРосГосНефть». Наша цель - рассчитать прибыльность регионов для бурения на основании данных разведовательной команды и выбрать регион для дальнейшей разработки.
Никакой бумаги с ручкой - все в Юпитере с применением моделей машинного обучения.  

Сразу отмечу, что учебные проекты в Практикуме представлены в виде удобного технического задания с примерной разметкой выполнения.
Приведу небольшой отрывок:

<p align='center'>
  <img src="https://i.ibb.co/kMG88vv/ypw-001.jpg">
</p>  

Данных подход позволяет придерживаться четкой структуры и приучает к последовательному анализу данных.  

<h3>Начало проекта</h3>

Вводные получены, переходим к выполнению проекта. Финальный результат рассматривает наставник, он же ревьюер, он же опытный сайентист или аналитик, который требует оформления учебного проекта, как настоящего работчего отчета. 
По этому, любое решение начинается с нулевого шага, в котором собирается вся вводная информация, происходит постановка целей и задач, расписывается план работы.

<p align='center'>
  <img src="https://i.ibb.co/BnH27ps/ypw-002.jpg" title='Нулевой шаг проекта'></a>
</p>  

Основными проблемными моментами в проекте могла стать предобработка данны, ведь никто не знает, что нам подготовили преподаватели Практикума, использование новой техники Bootstrap, возможные проблемы при выборе лучшего региона в случае похожих характеристик.  

С первым пунктом проблем не возникло - 3 региона для исследования, пропусков не обнаружено, всего 3 фичи на каждую скважину в регионе. И как говорит наставник: "Качественная визуализация спасет мир."

<p align='center'>
  <img src="https://i.ibb.co/10jC6cb/ypw-003.jpg" title='Часть первичных выводов и визуализация'>
</p>


<h3>Обучение моделей</h3>

Автоматизация вычислений - одно из главных требований наставников. Это началось с самого первого проекта и продолжается постоянно. Каждый проект требует сворачивания новых функций для однородных вычислений. В одном из чатов слака даже есть небольшое соревноваение, кто оформит функцию, требущую минимум времени при большом объеме обрабатываемой информации.  

В текущем проекте можно было использовать только логистическую регрессию в качестве основного инструмента. Нам надо найти несколько показателей: 

<p align='center'>
  <img src="https://i.ibb.co/y0PHKyL/ypw-004.jpg" title='Автоматизируем рассчеты'>
</p>

Как быстро накапливаются знания и практический опыт в практикуме - с момента прохождения проекта и написанием этой статьи прошло 2 месяца, но я нашел минимум 2 пункта, которые можно добавить в функцию для ускорения и облегчения вычислений.  

Регионы проанализированны, лучшие показатели найдены, переходим к следующему этапу.

<h3>Рассчет прибыли</h3>  

Вспомним, для чего нужен Bootstrap.   
Чтобы получить нужную величину, например, среднее, из исходного набора данных формируют подвыборки (псевдовыборки). На каждой из них и вычисляют среднее. Теоретически формировать подвыборки и рассчитывать по ним нужную величину можно многократно. Так мы получим несколько значений интересующего показателя и оценим распределение.  

Название техники произошло от выражения to pull oneself up by one's bootstraps (англ. «вытащить себя за ремешки ботинок»). Эта метафора означает, что «невозможное возможно» без посторонней помощи.  

Бутстреп применим для любых выборок. Это полезно, когда:

    Наблюдения не описываются нормальным законом;
    Для искомых величин нет статистических тестов.

В действительности не стоит всегда рассчитывать на нормальное распределение.  
Отберем 200 лучших скважин из случайной подвыборки в 500 скважин, рассчитаем. Повторим такой отбор 1000 раз и посмотрим, насколько стабильно мы сможем получать усредненные значения прибыли. Или сколько мы сможем заработать в каждом регионе, если начнем разрабатывать случайные 500 скважин. 

На первом этапе, и это пока не бустреп, посчитаем выручку для 200 лучших скважин из 500 случайных.

<p align='center'>  
  <img src="https://i.ibb.co/5MVssLT/ypw-005.jpg" title='Подсчет прибыли с бустрепом'>
</p>  

Некоторые регионы показали очень хорошие результаты:  

    Чистая прибыль от добычи нефти в Регионе 0 = 93.679 млрд. руб

Обернем функцию получения прибыли в бустреп с 1000 повторений, получим длинный массив, но показывать мы его, конечно же, не будем.
  
<p align='center'>
  <img src="https://i.ibb.co/jybF9Mm/ypw-006.jpg" title='bootstrap'>
</p> 

<h3>Сравнение возможной прибыли</h3>  

Возвращаемся к визуализации и строим доверительные интервалы среднего для бустрепных выборок.   

<p align='center'> 
  <img src="https://i.ibb.co/Qm1yDgJ/ypw-007.jpg" title='Сравнение доверительных интервалов'>
</p>  

Компании «ГлавРосГосНефть» несказанно повезло. Если данные разведки верны, прибыль в каждом регионе превысит 90 млрд рублей, что при затратах на разработку в 10 млрд, дает очень вкусные показатели чистой прибыли.

<h3>В качестве заключения</h3> 
Если бы мы действительно были сотрудниками этой компании, видя такие цифры, можно было бы попросить хороший бонус за проведенный анализ.  
Но это пока мечты, которые можно воплотить, получив знания в Яндекс.Практикум.  

К слову, проект приняли только после двух стадий доработки. И то, что наставники не принимают проекты, пока они не соответсвуют реальным рабочим отчетам, является дополнительным бонусом к учебному процессу.
